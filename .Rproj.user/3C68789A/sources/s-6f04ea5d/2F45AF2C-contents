# total value counter for the Major Achievements
value_count <- function(program_name, columnname) {
  data <- vin_latest
  count <- data %>%
    filter(program == program_name) %>%
    select(columnname) %>%
    na.omit() %>%
    sum()
  return(count)
}

we_benefits <- value_count("Women Empowerment", "beneficiaries")
we_activity <- value_count("Women Empowerment", "number_of_activities")

cd_benefits <- value_count("Children Development", "beneficiaries")
cd_activity <- value_count("Children Development", "number_of_activities")

ec_benefits <- value_count("Environment and conservation", "beneficiaries")
ec_activity <- value_count("Environment and conservation", "number_of_activities")

ph_benefits <- value_count("Public Health and medical care Program", "beneficiaries")
ph_activity <- value_count("Public Health and medical care Program", "number_of_activities")

ye_benefits <- value_count("Youth Empowerment", "beneficiaries")
ye_activity <- value_count("Youth Empowerment", "number_of_activities")


dr_overview <- function(program_name, columnname) {
  data <- vin_disaster_response %>% 
    filter(activity == columnname) %>% 
    select(beneficiaries)
}

dr_districts <- dr_overview("Disaster Response", "Districts reached out")
dr_family <- dr_overview("Disaster Response", "Families reached out to")
dr_population <- dr_overview("Disaster Response", "Population reached out to")
dr_volunteers <- dr_overview("Disaster Response", "Total human resource / volunteers mobilized")

                



# Number of Activities and Programs from the yearly data
# vin_activity_counter <- function(time_df) {
#   vin_year_data <- vin_latest %>% 
#     filter(year == time_df)
# 
#   vin_activity_count <- vin_year_data %>%
#     select(-detail_of_activities) %>%
#     filter(year == year) %>%
#     group_by(program, projects) %>%
#     summarise(activity = sum(number_of_activities, na.rm = TRUE))
# 
#   total_program <- vin_activity_count %>%
#     group_by(program) %>%
#     summarise(total = sum(activity, na.rm = TRUE))
#   pivot_program <- vin_activity_count %>% 
#     pivot_wider(names_from = projects, values_from = activity)
# 
#   activity_data <- bind_cols(pivot_program, total_program)
# 
#   return(activity_data)
# }
# 
# 
# vin_activity_counter(2018)

vin_beneficiary_counter <- function(program_name) {
  
  vin_beneficiary_count <- vin_latest %>%
    filter(program == program_name) %>%
    select(-c("program", "year")) %>% 
    group_by(projects) %>%
    summarise(total_beneficiary = sum(beneficiaries, na.rm = TRUE),
              total_activity = sum(number_of_activities, na.rm = TRUE)
                                ) %>% 
    arrange(-total_beneficiary)
  
  return(vin_beneficiary_count)

}

sum_vin_beneficiary <- vin_latest %>% 
  summarise(total_beneficiary = sum(beneficiaries, na.rm = TRUE))


sum_volunteers <- vin_latest %>% 
  filter(program == "Volunteering") %>% 
  summarise(total_volunteers = sum(beneficiaries, na.rm = TRUE))


wm_beneficiary <- vin_beneficiary_counter("Women Empowerment")
cd_beneficiary <- vin_beneficiary_counter("Children Development")
ye_beneficiary <- vin_beneficiary_counter("Youth Empowerment")
ph_beneficiary <- vin_beneficiary_counter("Public Health and medical care Program")
ec_beneficiary <- vin_beneficiary_counter("Environment and conservation")
vl_beneficiary <- vin_beneficiary_counter("Volunteering")






top_activities <- function(program_name) {
  
  top_activity <- vin_latest %>%
    filter(program == program_name) %>%
    select(-c("program", "year")) %>% 
    group_by(projects) %>% 
    arrange(-beneficiaries) 
  
  return(top_activity)
}

top_wm_beneficiary <- top_activities("Women Empowerment")
top_cd_beneficiary <- top_activities("Children Development")
top_ye_beneficiary <- top_activities("Youth Empowerment")
top_ph_beneficiary <- top_activities("Public Health and medical care Program")
top_ec_beneficiary <- top_activities("Environment and conservation")



# vin_2017_activity_count <- vin_yearly %>%
#   select(-detail_of_activities) %>%
#   filter(year == 2017) %>%
#   group_by(program, projects) %>%
#   summarise(activity = sum(number_of_activities, na.rm = TRUE))

# bind_cols(vin_2017_activity_count %>% pivot_wider(names_from = projects, values_from = activity), vin_2017_activity_count %>% group_by(program) %>% summarise(total = sum(activity, na.rm = TRUE))) %>% View()
