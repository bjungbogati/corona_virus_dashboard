
data_extracter <- function(df, column) {
  data <- df %>% 
    filter(program == column)
}

## Yearly Participants charts

yearly_hc <- highchart() %>%
  hc_xAxis(categories = vin_year_report$year) %>%
  hc_add_series(name = "International", data = vin_year_report$international) %>%
  hc_add_series(name = "National", data = vin_year_report$national) %>%
  hc_add_series(
    name = "Total",
    data = vin_year_report$total
  ) %>%
  hc_title(text = "VIN Volunteers by Year") %>%
  hc_add_theme(hc_theme_google()) %>%
  hc_tooltip(table = TRUE, sort = TRUE)


#htmlwidgets::saveWidget(yearly_hc, file="vin_year_volunteers.html")


## Volunteer by Country

country_2018_map <- hcmap("custom/world-robinson-highres", 
                          data = vin_2018_country, 
                          value = "total",
      joinBy =  c("name","country")) %>%
  hc_colorAxis(stops = color_stops()) %>% 
  hc_title(text = "Volunteers Nationality") %>% 
  hc_subtitle(text = "2018") %>%
  hc_tooltip(borderWidth = 1.5, headerFormat = "", 
             valueSuffix = "  Volunteers") %>%
  hc_add_theme(hc_theme_google()) %>%   
  hc_mapNavigation(enabled = TRUE) 

#htmlwidgets::saveWidget(country_2018_map, file="vin_country_2018_map.html")


## Volunteer by Continents
continent_2018_map <- hcmap("custom/world-continents", 
                            data = vin_2018_continent, 
                            value = "volunteer",
                            joinBy =  c("name","continent")) %>%
  hc_colorAxis(stops = color_stops()) %>% 
  hc_title(text = "Volunteers  based on Continent") %>% 
  hc_subtitle(text = "2018") %>%
  hc_tooltip(borderWidth = 1.5, headerFormat = "", 
             valueSuffix = "  Volunteers") %>%
  hc_add_theme(hc_theme_google()) %>%   
  hc_mapNavigation(enabled = TRUE) 



data_extracter <- function(df, column) {
  data <- df %>% 
    filter(program == column)
}

## Yearly Participants charts
yearly_hc <- highchart() %>%
  hc_xAxis(categories = vin_year_report$year) %>%
  hc_add_series(name = "International", data = vin_year_report$international) %>%
  hc_add_series(name = "National", data = vin_year_report$national) %>%
  hc_add_series(
    name = "Total",
    data = vin_year_report$total
  ) %>%
  hc_title(text = "VIN Volunteers by Year") %>%
  hc_add_theme(hc_theme_google()) %>%
  hc_tooltip(table = TRUE, sort = TRUE)



#htmlwidgets::saveWidget(yearly_hc, file="vin_year_volunteers.html")


## Volunteer by Country

country_2018_map <- hcmap("custom/world-robinson-highres", 
                          data = vin_2018_country, 
                          value = "total",
                          joinBy =  c("name","country")) %>%
  hc_colorAxis(stops = color_stops()) %>% 
  hc_title(text = "Volunteers Nationality") %>% 
  hc_subtitle(text = "2018") %>%
  hc_tooltip(borderWidth = 1.5, 
             headerFormat = "", 
             valueSuffix = "  Volunteers") %>%
  hc_add_theme(hc_theme_google()) %>%   
  hc_mapNavigation(enabled = TRUE) 

#htmlwidgets::saveWidget(country_2018_map, file="vin_country_2018_map.html")

## Volunteer by Continents
continent_2018_map <- hcmap("custom/world-continents", 
                            data = vin_2018_continent, 
                            value = "volunteer",
                            joinBy =  c("name", "continent")) %>%
  hc_colorAxis(stops = color_stops()) %>% 
  hc_title(text = "Volunteers  based on Continent") %>% 
  hc_subtitle(text = "2018") %>%
  hc_tooltip(borderWidth = 1.5, headerFormat = "", 
             valueSuffix = "  Volunteers") %>%
  hc_add_theme(hc_theme_google()) %>%   
  hc_mapNavigation(enabled = TRUE) 

#htmlwidgets::saveWidget(continent_2018_map, file="vin_continent_2018_map.html")


## Yearly Visualization with function

project_plot <- function(data, charttype, plot_title){
  
highchart() %>% 
    # Data
    hc_add_series(data, type = charttype, 
                  hcaes(x = projects, y = total_beneficiary, z = total_activity),
                  name = "Beneficiaries") %>%
    
    hc_tooltip(pointFormat = "<b>Frequency:</b> {point.z} 
               <br> <b>Beneficiaries:</b> {point.y}")  %>% 
    
    hc_plotOptions(
      series = list(
        showInLegend = FALSE,
        dataLabels = list(enabled = TRUE)
      ),
      column = list(
        colorByPoint = TRUE
      )) %>%
    
    hc_xAxis(categories = data$projects) %>%
    # Titles and credits
    hc_title(
      text = plot_title
    ) %>%
    hc_add_theme(hc_theme_google()) %>% 
    hc_colors(colorset)
  
}


disaster_response_plot <- function(project_name, charttype){
  
  data <- vin_disaster_response %>% 
    filter(project == project_name) %>% 
    arrange(-beneficiaries)
  
  highchart() %>% 
    # Data
    hc_add_series(data, type = charttype, 
                  hcaes(x = activity, y = beneficiaries),
                  name = "Beneficiary") %>%
    
    hc_plotOptions(
      series = list(
        showInLegend = FALSE,
        dataLabels = list(enabled = TRUE)
      ),
      column = list(
        colorByPoint = TRUE
      )) %>%
    
    hc_xAxis(categories = data$activity) %>%
    # Titles and credits
    hc_title(
      text = project_name
    ) %>%
    hc_add_theme(hc_theme_google()) %>% 
    hc_colors(colorset)
  
}

top_beneficiary_plot <- function(data, charttype, plot_title){
  
  highchart() %>% 
    hc_add_series(data, type = charttype, 
                  hcaes(x = detail_of_activities, y = beneficiaries)) %>%
    
    hc_tooltip(pointFormat = "<b>Frequency:</b> {point.x} 
               <br> <b>Beneficiaries:</b> {point.y}")  %>% 
    
    
    hc_plotOptions(
      series = list(
        showInLegend = FALSE,
        dataLabels = list(enabled = TRUE)
      ),
      column = list(
        colorByPoint = TRUE
      )) %>%
    
    # Titles and credits
    hc_title(
      text = plot_title
    ) %>%
    hc_add_theme(hc_theme_google()) %>% 
    hc_colors(colorset)
  
}

#htmlwidgets::saveWidget(continent_2018_map, file="vin_continent_2018_map.html")

## Yearly Visualization with function

